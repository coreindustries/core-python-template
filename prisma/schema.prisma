// Prisma Schema
// Documentation: https://pris.ly/d/prisma-schema

generator client {
  provider             = "prisma-client-py"
  interface            = "asyncio"
  recursive_type_depth = 5
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =============================================================================
// Example Models - Uncomment and modify as needed
// =============================================================================

// model User {
//   id        String   @id @default(cuid())
//   email     String   @unique
//   name      String
//   createdAt DateTime @default(now()) @map("created_at")
//   updatedAt DateTime @updatedAt @map("updated_at")

//   @@map("users")
// }

// =============================================================================
// Embedding Model for Vector Search
// =============================================================================
// Note: The 'embedding' vector column is added via raw SQL migration
// because Prisma doesn't natively support the vector type.
// See: prisma/migrations/add_vector_column.sql

model Embedding {
  id        String   @id @default(cuid())
  content   String
  metadata  Json?
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("embeddings")
}

// =============================================================================
// Vector Extension for pgvector
// =============================================================================

// To use pgvector, you'll need to:
// 1. Enable the extension in PostgreSQL: CREATE EXTENSION IF NOT EXISTS vector;
// 2. Run the vector column migration after Prisma migration
//
// Vector column migration (run after prisma migrate):
// ALTER TABLE embeddings ADD COLUMN IF NOT EXISTS embedding vector(1536);
// CREATE INDEX IF NOT EXISTS embeddings_embedding_idx
//   ON embeddings USING ivfflat (embedding vector_cosine_ops) WITH (lists = 100);
